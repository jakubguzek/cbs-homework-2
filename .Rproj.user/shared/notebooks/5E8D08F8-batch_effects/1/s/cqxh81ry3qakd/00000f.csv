"0","# Add the surrogate variables to the model matrix"
"0","modsva = lm(t(edata) ~ as.factor(pheno$cancer) + sva_output$sv)"
"0","modsva_tidy <- tidy(modsva)"
"0",""
"0","est_compare <- tibble("
"0","  LinearModel = mod_tidy %>% filter(term == ""as.factor(pheno$cancer)Cancer"") %>% select(""estimate"") %>% unlist,"
"0","  "
"0","  ComBat = modcombat_tidy %>% filter(term == ""as.factor(pheno$cancer)Cancer"") %>% select(""estimate"") %>% unlist,"
"0","  "
"0","  SVA = modsva_tidy %>% filter(term == ""as.factor(pheno$cancer)Cancer"") %>% select(""estimate"") %>% unlist)"
"0",""
"0","ggplot(est_compare, aes(x=LinearModel, y=SVA)) +"
"0","     geom_point(col=""darkgrey"", alpha=.5, size=.5) + geom_abline(intercept=0, slope=1, col=""darkred"") + geom_smooth(method = ""lm"", se = TRUE)  + theme_bw()"
